ä»Šæ—¥ã®é€²æ—ãƒ»çŠ¶æ³
Firebase Emulator ã‚’èµ·å‹•ã—ã‚ˆã†ã¨ã—ãŸãŒã€è¤‡æ•°ãƒãƒ¼ãƒˆãŒã™ã§ã«ä½¿ç”¨ä¸­ã§èµ·å‹•ã§ããªã„ã€‚

ãƒ­ã‚°ã«å‡ºã¦ã„ã‚‹è©²å½“ãƒãƒ¼ãƒˆï¼š

Auth Emulator â†’ 9097

Firestore Emulator â†’ 8082

Storage Emulator â†’ 9197

Emulator UI â†’ 4000

Logging Emulator â†’ 4500

Could not start Emulator UI, port taken ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ã‚ã‚Šã€‚

åŸå› ã¯ å¤ã„ãƒ—ãƒ­ã‚»ã‚¹ãŒæ®‹ã£ã¦ã„ã¦ãƒãƒ¼ãƒˆã‚’å æœ‰ã—ã¦ã„ã‚‹çŠ¶æ…‹ã€‚

æ˜æ—¥ã‚„ã‚‹æ‰‹é †ï¼ˆãŠã™ã™ã‚ï¼‰
å¤ã„ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã¾ã¨ã‚ã¦åœæ­¢

bash
ã‚³ãƒ”ãƒ¼ã™ã‚‹
ç·¨é›†ã™ã‚‹
npx kill-port 3000 4000 5001 8080 8082 9097 9197 4500
â€» å®Ÿè¡Œæ™‚ã« Need to install the following packages: kill-port ã¨å‡ºãŸã‚‰ã€y ã‚’æŠ¼ã—ã¦ Enter

Emulator å†èµ·å‹•

bash
ã‚³ãƒ”ãƒ¼ã™ã‚‹
ç·¨é›†ã™ã‚‹
firebase emulators:start
â†’ ã‚¨ãƒ©ãƒ¼ãŒæ¶ˆãˆã‚‹ã¯ãš

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚‚èµ·å‹•

bash
ã‚³ãƒ”ãƒ¼ã™ã‚‹
ç·¨é›†ã™ã‚‹
npm run dev
ã¾ãŸã¯ vite ã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã¯ãã®ã‚³ãƒãƒ³ãƒ‰

ã‚‚ã—ã¾ã ãƒãƒ¼ãƒˆç«¶åˆãŒå‡ºãŸã‚‰

ã‚¨ãƒ©ãƒ¼ã§è¡¨ç¤ºã•ã‚ŒãŸãƒãƒ¼ãƒˆç•ªå·ã‚’ç¢ºèª

ãã®ç•ªå·ã‚’ npx kill-port <ç•ªå·> ã§è¿½åŠ åœæ­¢

ã“ã‚Œã§ç¢ºå®Ÿã«ã€Œãƒãƒ¼ãƒˆã®å–ã‚Šåˆã„å•é¡Œã€ã‚’è§£æ¶ˆã—ã¦å†èµ·å‹•ã§ãã‚‹ã¯ãšã§ã™ã€‚

ã“ã®æµã‚Œã§ã„ãã¾ã™ã‹ï¼Ÿ
æ˜æ—¥ã¯â‘ ã‚’å…ˆã«ã‚„ã‚Œã°ã™ãå†é–‹ã§ãã‚‹çŠ¶æ…‹ã§ã™ã€‚


ä½œæ¥­ãƒ¡ãƒ¢ï¼ˆ2025-08-12ï¼‰
1. çŠ¶æ³
ãƒãƒˆãƒ«çµ‚äº†æ™‚ã« saveBattleRecord() ãŒæ­£ã—ãå‘¼ã°ã‚Œã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã¯
ğŸ“ saveBattleRecord payload: â†’ âœ… battles written docId: ãŒå‡ºã¦ã„ã‚‹

ã¤ã¾ã‚Šæ›¸ãè¾¼ã¿ã¯æˆåŠŸã—ã¦ã„ã‚‹

ã—ã‹ã— Firestore Emulator UI ã« battles ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œãªã„

2. åˆ¤æ˜ã—ãŸåŸå› å€™è£œ
Emulator UI ãŒè¦‹ã¦ã„ã‚‹ ProjectId ã¨ã€ã‚¢ãƒ—ãƒªã®æ¥ç¶š ProjectId ãŒé•ã†

Emulator Overview ã§ã¯ gachaben-2025

ã‚¢ãƒ—ãƒªã® firebase.js ã¯ demo-gachaben

ãã®ãŸã‚ UI ã® URL ã‚’åˆ‡ã‚Šæ›¿ãˆã¦ã‚‚ä¸€è‡´ã›ãšãƒ‡ãƒ¼ã‚¿ãŒè¦‹ãˆãªã„

Firebase App named '[DEFAULT]' already exists... ã‚¨ãƒ©ãƒ¼ï¼ˆduplicate-appï¼‰

initializeApp() ãŒè¤‡æ•°å›èµ°ã£ã¦ã„ã‚‹

firebase_old.js ã‚„è¤‡æ•° import ã®å½±éŸ¿ã®å¯èƒ½æ€§ã‚ã‚Š

3. ä»Šæ—¥è©¦ã—ãŸã“ã¨
Firestore UI ã®URLã‚’ .../firestore/{projectId}/(default)/data ã«å¤‰æ›´ã—ã¦ç¢ºèª

.firebaserc ã‚’ä½œã£ã¦ "default": "demo-gachaben" ã«è¨­å®š

Requests ã‚¿ãƒ–ã§ã®ç¢ºèªã‚‚è©¦ã¿ãŸãŒã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œãš

ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã§ âœ… battles written docId: ã¯æ¯å›å‡ºã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

4. æ¬¡å›ã‚„ã‚‹ã“ã¨ï¼ˆå„ªå…ˆé †ï¼‰
firebase.js ã®ä¿®æ­£ï¼ˆduplicate-appå¯¾ç­–ï¼†projectIdçµ±ä¸€ï¼‰

js
ã‚³ãƒ”ãƒ¼ã™ã‚‹
ç·¨é›†ã™ã‚‹
import { initializeApp, getApp, getApps } from "firebase/app";
import { getAuth, connectAuthEmulator } from "firebase/auth";
import { getFirestore, connectFirestoreEmulator } from "firebase/firestore";

const firebaseConfig = {
  apiKey: "demo",
  authDomain: "demo.firebaseapp.com",
  projectId: "demo-gachaben", // â† .firebaserc ã¨åˆã‚ã›ã‚‹
};

const app = getApps().length ? getApp() : initializeApp(firebaseConfig);

export const auth = getAuth(app);
export const db = getFirestore(app);

if (location.hostname === "localhost" || location.hostname === "127.0.0.1") {
  connectAuthEmulator(auth, "http://127.0.0.1:9099");
  connectFirestoreEmulator(db, "127.0.0.1", 8080);
  console.log("[EMU] connected â†’ Auth:9099 / Firestore:8080");
  console.log("[EMU] projectId =", getApp().options.projectId);
}
.firebaserc ã‚’ä»¥ä¸‹ã®å†…å®¹ã«ã™ã‚‹ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›´ä¸‹ï¼‰

json
ã‚³ãƒ”ãƒ¼ã™ã‚‹
ç·¨é›†ã™ã‚‹
{
  "projects": {
    "default": "demo-gachaben"
  }
}
Vite ã¨ Emulator ã‚’ä¸€åº¦åœæ­¢ã—ã¦å†èµ·å‹•

firebase emulators:start

npm run dev

ãƒ–ãƒ©ã‚¦ã‚¶ã§ [EMU] projectId = demo-gachaben ãŒå‡ºã¦ã„ã‚‹ã‹ç¢ºèª

Firestore UI ã®URLã‚’
http://localhost:4001/firestore/demo-gachaben/(default)/data ã«ã—ã¦ç¢ºèª

ã‚‚ã—è¡¨ç¤ºã•ã‚Œãªã‘ã‚Œã°

Logsã‚¿ãƒ–ã§ ProjectId ã‚’ç¢ºèª

Requestsã‚¿ãƒ–ã§è¡ŒãŒå‡ºã‚‹ã‹ç¢ºèª

firebase_old.js ã® import ãŒæ®‹ã£ã¦ã„ãªã„ã‹æ¤œç´¢

ã“ã®ç¶šãã¯ã€Œfirebase.js ã®ä¿®æ­£ç‰ˆã€ã¨ã€Œ.firebaserc ã®è¨­å®šç¢ºèªã€ã‹ã‚‰å§‹ã‚ã‚Œã°OKã€‚
ã“ã“ã¾ã§ç›´ã‚Œã°ã€Emulator UI ã« battles ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãŒå‡ºã‚‹ã¯ãšã€‚
